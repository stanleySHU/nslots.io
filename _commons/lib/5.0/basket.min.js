/*!
* basket.js
* v0.5.2 - 2015-02-07
* http://addyosmani.github.com/basket.js
* (c) Addy Osmani;  License
* Created by: Addy Osmani, Sindre Sorhus, AndrÃ©e Hansson, Mat Scales
* Contributors: Ironsjp, Mathias Bynens, Rick Waldron, Felipe Morais
* Uses rsvp.js, https://github.com/tildeio/rsvp.js
* Modified by KCG for localStorage Access Denied Handling
*/
!function(e,t){"use strict";var n=t.head||t.getElementsByTagName("head")[0],r=[],a={};try{a=localStorage||{}}catch(e){console.log("StorageError: ",e)}var u=function(e,t){try{return localStorage.setItem("basket-"+e,JSON.stringify(t)),!0}catch(i){if(i.name.toUpperCase().indexOf("QUOTA")>=0){var n,r=[];for(n in a)0===n.indexOf("basket-")&&r.push(JSON.parse(localStorage[n]));return r.length?(r.sort(function(e,t){return e.stamp-t.stamp}),basket.remove(r[0].key),u(e,t)):void 0}return}},i=function(e){return(t=e.url,new RSVP.Promise(function(e,n){var r=new XMLHttpRequest;r.open("GET",t),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||0===r.status&&r.responseText?e({content:r.responseText,type:r.getResponseHeader("content-type")}):n(new Error(r.statusText)))},setTimeout(function(){r.readyState<4&&r.abort()},basket.timeout),r.send()})).then(function(t){var n=o(e,t);return e.skipCache||u(e.key,n),n});var t},o=function(e,t){var n=+new Date;return e.data=t.content,e.originalType=t.type,e.type=e.type||t.type,e.skipCache=e.skipCache||!1,e.stamp=n,e.expire=n+60*(e.expire||5e3)*60*1e3,e},c=function(e){var t,n,r;if(e.url)return e.key=e.key||e.url,t=basket.get(e.key),e.execute=!1!==e.execute,r=function(e,t){return!e||e.expire-+new Date<0||t.unique!==e.unique||basket.isValidItem&&!basket.isValidItem(e,t)}(t,e),e.live||r?(e.unique&&(e.url+=(e.url.indexOf("?")>0?"&":"?")+"basket-unique="+e.unique),n=i(e),e.live&&!r&&(n=n.then(function(e){return e},function(){return t}))):(t.type=e.type||t.originalType,t.execute=e.execute,n=new RSVP.Promise(function(e){e(t)})),n},s={default:function(e){var r=t.createElement("script");r.defer=!0,r.text=e.data,n.appendChild(r)}},l=function(e){return e.map(function(e){return e.execute&&function(e){e.type&&s[e.type]?s[e.type](e):s.default(e)}(e),e})},f=function(){var e,t,n=[];for(e=0,t=arguments.length;e<t;e++)n.push(c(arguments[e]));return RSVP.all(n)},p=function(){var e=f.apply(null,arguments),t=this.then(function(){return e}).then(l);return t.thenRequire=p,t};e.basket={require:function(){for(var e=0,t=arguments.length;e<t;e++)arguments[e].execute=!1!==arguments[e].execute,arguments[e].once&&r.indexOf(arguments[e].url)>=0?arguments[e].execute=!1:!1!==arguments[e].execute&&r.indexOf(arguments[e].url)<0&&r.push(arguments[e].url);var n=f.apply(null,arguments).then(l);return n.thenRequire=p,n},remove:function(e){try{return localStorage.removeItem("basket-"+e),this}catch(e){return!1}},get:function(e){try{var t=localStorage.getItem("basket-"+e);return JSON.parse(t||"false")}catch(e){return!1}},clear:function(e){var t,n,r=+new Date;for(t in a)(n=t.split("basket-")[1])&&(!e||this.get(n).expire<=r)&&this.remove(n);return this},isValidItem:null,timeout:5e3,addHandler:function(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(e){s[e]=t})},removeHandler:function(e){basket.addHandler(e,void 0)}},basket.clear(!0)}(this,document);
//# sourceMappingURL=basket.full.min.js.map